<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Town Docs</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="ReadFirst.html"><strong aria-hidden="true">2.</strong> Read First</a></li><li class="chapter-item expanded "><a href="TheEditor.html"><strong aria-hidden="true">3.</strong> The Editor</a></li><li class="chapter-item expanded "><a href="GameState.html"><strong aria-hidden="true">4.</strong> Game State</a></li><li class="chapter-item expanded "><a href="GameValues.html"><strong aria-hidden="true">5.</strong> Game Values</a></li><li class="chapter-item expanded "><a href="Services/index.html"><strong aria-hidden="true">6.</strong> Services</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Services/characterService.html"><strong aria-hidden="true">6.1.</strong> Character Service</a></li><li class="chapter-item expanded "><a href="Services/gameService.html"><strong aria-hidden="true">6.2.</strong> Game Service</a></li><li class="chapter-item expanded "><a href="Services/playerService.html"><strong aria-hidden="true">6.3.</strong> Player Service</a></li><li class="chapter-item expanded "><a href="Services/toastService.html"><strong aria-hidden="true">6.4.</strong> Toast Service</a></li></ol></li><li class="chapter-item expanded "><a href="Examples/index.html"><strong aria-hidden="true">7.</strong> Examples</a></li><li class="chapter-item expanded "><a href="TODO.html"><strong aria-hidden="true">8.</strong> Documentation TODO</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Town Docs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This book is the documentation for programatically interacting with The Town game. Like the game this is very much a work in progress.</p>
<h2 id="to-beginners"><a class="header" href="#to-beginners">To Beginners</a></h2>
<p>I hope this serves as a fun way to learn how to program logic to interact with and automate various processes within the game.</p>
<p>While this documentation provides code examples, you may also benefit from practicing with online resources.</p>
<ul>
<li><a href="https://www.codecademy.com/learn/introduction-to-javascript" target="_blank">Codecademy</a> - is a great free resource for learning JavaScript.</li>
<li>Google (or search engine of choice) + Stack Overflow - as you search for answers to code questions you are likely to end up on Stack Overflow, which will most liekly be relevant to your question or often, the answer.</li>
</ul>
<h2 id="to-non-beginners"><a class="header" href="#to-non-beginners">To Non-Beginners</a></h2>
<p>I hope this serves as a fun way to put your programming skills to the test by automating various processes within the game using JavaScript.</p>
<p>As you work with the provided interfaces for interacting with the game, you may notice some things that may not be considered best practice. While I try to adhear to good practces, some choices I make are to create as simple of an interface as possible for anyone who might be interested in trying to build scripts for the game. All of this is likely to evolve as the game's implemenation starts to settle.</p>
<p>If there is interest in being able to interact with the game in other languages using a websocket connection, I can enhance the documentation to explain other processes not described here, such as how to login.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="read-first"><a class="header" href="#read-first">Read First</a></h1>
<h2 id="fail-safe"><a class="header" href="#fail-safe">Fail safe</a></h2>
<p>In the event that you happen to introduce an infinite loop into your script, or it is doing somthing else undesired, add <code>?scriptSaveMode=1</code> to the URL.</p>
<p><a href="http://thetowngame.com/?scriptSafeMode=1">http://thetowngame.com/?scriptSafeMode=1</a></p>
<h2 id="request-limits"><a class="header" href="#request-limits">Request Limits</a></h2>
<p>Currently each player is limited to 120 requests every minute.</p>
<h2 id="code-structure-and-execution"><a class="header" href="#code-structure-and-execution">Code structure and execution</a></h2>
<p>Execution begins with the file specified in the editor. That file may be used to &quot;require&quot; other files using the <code>require</code> function. Here is an example usage:</p>
<pre><code class="language-javascript">// Loads the configuration file to setup values for the rest of the scripts
require(&quot;configure&quot;);

// Load the file that sets up the different timers used to check and react to game state
const timers = require(&quot;timers&quot;);

// Start the timers
timers.start();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-editor"><a class="header" href="#the-editor">The Editor</a></h1>
<h2 id="making-changes"><a class="header" href="#making-changes">Making changes</a></h2>
<p>Any changes made are immediately saved, but the script is not reloaded until requested.</p>
<h2 id="files"><a class="header" href="#files">Files</a></h2>
<p>&quot;Files&quot; are stored locally. Future enhancements will allow them to be stored with game data so that they may be transferred between devices.</p>
<p>Files may be added and deleted through the buttons on the right column.</p>
<p>Selecting a file will display it's code and allow it to be renamed via the button in the top right.</p>
<h2 id="entry"><a class="header" href="#entry">Entry</a></h2>
<p>A file must be selected as the entry point for the script, otherwise the script engine will not know where to start.</p>
<h2 id="script-state-and-actions"><a class="header" href="#script-state-and-actions">Script state and actions</a></h2>
<h3 id="running"><a class="header" href="#running">Running</a></h3>
<p>This is displayed if the script has successfully started and is running without encountering any errors.</p>
<h3 id="stopped"><a class="header" href="#stopped">Stopped</a></h3>
<p>This is displayed if the script has been manually stopped.</p>
<h3 id="errored"><a class="header" href="#errored">Errored</a></h3>
<p>This is displayed if the script encounters an error.</p>
<h3 id="stop--start"><a class="header" href="#stop--start">Stop / Start</a></h3>
<p>Either stop or start the script.</p>
<h3 id="restart"><a class="header" href="#restart">Restart</a></h3>
<p>Stops and then restarts the script.</p>
<h2 id="error-messages"><a class="header" href="#error-messages">Error Messages</a></h2>
<p>In order to try and make error traces more understandable, file code is wrapped in functions named by the file name, with spaces replaced by underscores. This enables proper line reporting for the evauated code.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-state"><a class="header" href="#game-state">Game State</a></h1>
<p>The client game state is stored locally and globally in <code>store.state</code>. There are a lot of properties in the store state, however you don't need to know all of them. This section will cover what should be most valuable.</p>
<p>For example to get to the character's current equipment.</p>
<pre><code class="language-javascript">const equipment = game.store.state.user.player.character.equipment;
</code></pre>
<h2 id="properties"><a class="header" href="#properties">Properties</a></h2>
<p>When referring to a property the <code>game.store.state</code> is assumed as the way to reference it. For example</p>
<pre><code class="language-javascript">const inventory = game.store.state.user.player.inventory;
</code></pre>
<h3 id="userplayer"><a class="header" href="#userplayer">user.player</a></h3>
<hr />
<h4 id="userplayerinventory"><a class="header" href="#userplayerinventory">user.player.inventory</a></h4>
<p>The current inventory</p>
<p>Can also use <code>store.getInventory()</code></p>
<h4 id="userplayercharacter"><a class="header" href="#userplayercharacter">user.player.character</a></h4>
<p>Get all of the character's data</p>
<p>Can also use <code>store.getCharacter()</code></p>
<h4 id="userplayeractivity"><a class="header" href="#userplayeractivity">user.player.activity</a></h4>
<p>The current activity of the player (ex &quot;battle&quot; | &quot;scavenge&quot; | &quot;repair&quot; | &quot;build&quot; | null)</p>
<h3 id="battle"><a class="header" href="#battle">battle</a></h3>
<hr />
<p>This property will contain data about the current battle you are participating in. It will be <code>null</code> otherwise.</p>
<h4 id="battlelevel"><a class="header" href="#battlelevel">battle.level</a></h4>
<p>The current level/difficulty of the battle</p>
<h4 id="battlesize"><a class="header" href="#battlesize">battle.size</a></h4>
<p>This array contains two items <code>[width, height]</code></p>
<h4 id="battleexpiration"><a class="header" href="#battleexpiration">battle.expiration</a></h4>
<p>The timestamp at which the battle will expire</p>
<h4 id="battleparticipants"><a class="header" href="#battleparticipants">battle.participants</a></h4>
<p>The timestamp at which the battle will expire</p>
<h4 id="battleparticipants-1"><a class="header" href="#battleparticipants-1">battle.participants</a></h4>
<p>This array will have a length of <code>width x height</code> and contain information about each character participating in the battle. The index of the player is reletive to their position in the battle grid.</p>
<h4 id="battleparticipants-2"><a class="header" href="#battleparticipants-2">battle.participants</a></h4>
<p>This array contains information about every other character not directory participating in the battle.</p>
<h4 id="battleenemies"><a class="header" href="#battleenemies">battle.enemies</a></h4>
<p>This array contains information about the active enemies in the battle.</p>
<h4 id="battlereserveenemies"><a class="header" href="#battlereserveenemies">battle.reserveEnemies</a></h4>
<p>This array contains information about enemies not currently active in the battle.</p>
<h4 id="battlescavengers"><a class="header" href="#battlescavengers">battle.scavengers</a></h4>
<p>This array contains information about the players that are currently scavenging.</p>
<h4 id="battleitemsavailable"><a class="header" href="#battleitemsavailable">battle.itemsAvailable</a></h4>
<p>The number of items available to be scavenged.</p>
<h4 id="battlehealslots"><a class="header" href="#battlehealslots">battle.healSlots</a></h4>
<p>This array contains a list of indexes that are targes for being healed.</p>
<h3 id="town"><a class="header" href="#town">town</a></h3>
<hr />
<h4 id="townhp"><a class="header" href="#townhp">town.hp</a></h4>
<p>The current HP of the town.</p>
<h4 id="townmaxhp"><a class="header" href="#townmaxhp">town.maxHp</a></h4>
<p>The max HP of the town.</p>
<h4 id="townhp-1"><a class="header" href="#townhp-1">town.hp</a></h4>
<p>The current HP of the town.</p>
<h4 id="townlastdamage"><a class="header" href="#townlastdamage">town.lastDamage</a></h4>
<p>The most recent amount of damage the town received.</p>
<h4 id="townlastrepair"><a class="header" href="#townlastrepair">town.lastRepair</a></h4>
<p>The most recent amount of repairing the town received.</p>
<h4 id="townrepairers"><a class="header" href="#townrepairers">town.repairers</a></h4>
<p>This array contains the players currently repairing the town</p>
<h4 id="townbuilders"><a class="header" href="#townbuilders">town.builders</a></h4>
<p>This object contains a property for each building and an array of the players participating in building it.</p>
<h4 id="townbuildings"><a class="header" href="#townbuildings">town.buildings</a></h4>
<p>This object contains a property for each building and number representing its level.</p>
<h4 id="townbuildingsexp"><a class="header" href="#townbuildingsexp">town.buildingsExp</a></h4>
<p>This object contains a property for each building and number representing its experience to the next level.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>The store provides some helper functions for getting to specific pieces of data</p>
<p><a href="GameState.html#getplayer">getPlayer</a></p>
<p><a href="GameState.html#getinventory">getInventory</a></p>
<p><a href="GameState.html#getcharacter">getCharacter</a></p>
<p><a href="GameState.html#getdifficulty">getDifficulty</a></p>
<h3 id="getplayer"><a class="header" href="#getplayer">getPlayer</a></h3>
<p>Get the player object</p>
<pre><code class="language-javascript">const player = game.store.getPlayer();
</code></pre>
<h3 id="getinventory"><a class="header" href="#getinventory">getInventory</a></h3>
<p>Get the inventory object</p>
<pre><code class="language-javascript">const inventory = game.store.getInventory();
</code></pre>
<h3 id="getcharacter"><a class="header" href="#getcharacter">getCharacter</a></h3>
<p>Get the character object</p>
<pre><code class="language-javascript">const character = game.store.getCharacter();
</code></pre>
<h3 id="getdifficulty"><a class="header" href="#getdifficulty">getDifficulty</a></h3>
<p>Get the current game difficulty</p>
<pre><code class="language-javascript">const difficulty = game.store.getDifficulty();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-values"><a class="header" href="#game-values">Game Values</a></h1>
<p>There are a number of configuration values that determine how game systems behave. These values can be helpful in making decisions within your script.</p>
<h3 id="example-usage"><a class="header" href="#example-usage">Example usage</a></h3>
<pre><code class="language-javascript">game.gameValues.RECOVERY_TIMER_MODIFIER;
</code></pre>
<h3 id="list-of-value-names"><a class="header" href="#list-of-value-names">List of value names</a></h3>
<table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody>
<tr><td>DIFFICULTY_ITEM_MODIFIER</td><td>Item level = battle.level * gameValues.DIFFICULTY_ITEM_MODIFIER</td></tr>
<tr><td>SCAVENGE_ITEM_AVAILABLE_BASE</td><td>Base value for scavenge chance when drops are available, added to the chance based on the player skill level</td></tr>
<tr><td>SCAVENGE_ITEM_UNAVAILABLE_BASE</td><td>Base value for scavenge chance when drops are available, added to the chance based on the player skill level</td></tr>
<tr><td>SCAVENGE_TICK_PERIOD</td><td>How how many ticks before the scavenge process should execute</td></tr>
<tr><td>RECOVERY_TIMER_MODIFIER</td><td>The number of ticks to recover after being knocked out. character.recoveryTimer += character.recoveryCounter * gameValues.RECOVERY_TIMER_MODIFIER</td></tr>
<tr><td>NON_BATTLE_HP_RECOVERY_MODIFIER</td><td>Amount of HP recovered when not in battle</td></tr>
<tr><td>TOWN_RECOVERY_TIME_MODIFIER</td><td>Number of ticks for the town rest after starting to loop</td></tr>
<tr><td>TOWN_BUILD_SKILL_LEVEL_MODIFIER</td><td>Base value for the expGrowth function. 1 / MathExtra.baseExpGrowth(gameValues.TOWN_BUILD_SKILL_LEVEL_MODIFIER, skillLevel);</td></tr>
<tr><td>TOWN_DAMAGE_MODIFIER</td><td>Modifier for damage applied to the town for each enemy. townDamage += enemy.level * gameValues.TOWN_DAMAGE_MODIFIER;</td></tr>
<tr><td>TOWN_TICK_PERIOD</td><td>How how many ticks before the town process should execute</td></tr>
<tr><td>TOWN_BASE_HP</td><td>Base HP for the town</td></tr>
<tr><td>BATTLE_ENEMY_DEFEAT_NEW_ITEMS</td><td>Number of itmes dropped when defeating an enemy</td></tr>
<tr><td>BATTLE_DIFFICULTY_DIVISOR</td><td>Used to determine the number of ticks to increase the battle difficulty (level). cycleTickCount / gameValues.BATTLE_DIFFICULTY_DIVISOR</td></tr>
<tr><td>BATTLE_AUTO_CREATION_RATIO</td><td>The minimum ratio of players to battle position slots required for a battle to be automatically created. True if the ratio is greater than this value</td></tr>
</tbody></table>
<p>TODO: create a script to generate the above names/descriptions</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="services"><a class="header" href="#services">Services</a></h1>
<p>This section describes the functions available from each service made available to the script engine. The organization of these services is likely to change in the future.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="character-service"><a class="header" href="#character-service">Character Service</a></h1>
<p>This service allows you to perform character specific actions.</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<p><a href="Services/characterService.html#equip">equip</a></p>
<p><a href="Services/characterService.html#unequip">unequip</a></p>
<hr />
<h3 id="equip"><a class="header" href="#equip">equip</a></h3>
<p>Equip an item</p>
<pre><code class="language-javascript">// Get the first item in the inventory
const item = game.store.getInventory()[0];

game.characterService.equip(item.id);
</code></pre>
<h3 id="unequip"><a class="header" href="#unequip">unequip</a></h3>
<p>Unequip an item</p>
<pre><code class="language-javascript">const equipment = game.store.getCharacter().equipment;

// Unequip the first item in the list of equipment
game.characterService.unequip(equipment[0]);
</code></pre>
<h3 id="get"><a class="header" href="#get">get</a></h3>
<p>Get character data about a logged in player</p>
<pre><code class="language-javascript">const username = &quot;admin&quot;;
const character = game.characterService.get(username);

// Do something with the character data
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-service"><a class="header" href="#game-service">Game Service</a></h1>
<p>This service contains the majoirty of the actions for interacting with the game.</p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<p><a href="Services/gameService.html#getbattles">getBattles</a></p>
<p><a href="Services/gameService.html#createbattle">createBattle</a></p>
<p><a href="Services/gameService.html#joinbattle">joinBattle</a></p>
<p><a href="Services/gameService.html#leavebattle">leaveBattle</a></p>
<p><a href="Services/gameService.html#selectbattleslot">selectBattleSlot</a></p>
<p><a href="Services/gameService.html#selectreserve">selectReserve</a></p>
<p><a href="Services/gameService.html#selectenemy">selectEnemy</a></p>
<p><a href="Services/gameService.html#startscavenge">startScavenge</a></p>
<p><a href="Services/gameService.html#stopscavenge">stopScavenge</a></p>
<p><a href="Services/gameService.html#startrepair">startRepair</a></p>
<p><a href="Services/gameService.html#stoprepair">stopRepair</a></p>
<p><a href="Services/gameService.html#startbuild">startBuild</a></p>
<p><a href="Services/gameService.html#savetraining">saveTraining</a></p>
<p><a href="Services/gameService.html#endbattle">endBattle</a></p>
<p><a href="Services/gameService.html#searchmarket">searchMarket</a></p>
<hr />
<h3 id="getbattles"><a class="header" href="#getbattles">getBattles</a></h3>
<p>Get a list of all globally known battles</p>
<pre><code class="language-javascript">await game.gameService.getBattles();
</code></pre>
<h3 id="createbattle"><a class="header" href="#createbattle">createBattle</a></h3>
<p>Craete a personal battle with the given difficulty. It cannot be less than 1 or more than the global difficulty.</p>
<pre><code class="language-javascript">// Create the simplest battle
await game.gameService.createBattle(1);
</code></pre>
<pre><code class="language-javascript">const difficulty = store.getDifficulty();

// Create a battle of the current max difficulty
game.gameService.createBattle(difficulty);
</code></pre>
<h3 id="joinbattle"><a class="header" href="#joinbattle">joinBattle</a></h3>
<p>Join the specified battle.</p>
<pre><code class="language-javascript">const firstBattle = store.state.battles[0];

// Join the battle at the top of the list if there is one
if (firstBattle) {
  await game.gameService.joinBattle(firstBattle.id);
}
</code></pre>
<h3 id="leavebattle"><a class="header" href="#leavebattle">leaveBattle</a></h3>
<p>Leave the current battle.</p>
<pre><code class="language-javascript">const { player } = store.state.user;

// Leave the battle if currently in one
if (player.battleId) {
  await game.gameService.leaveBattle();
}
</code></pre>
<h3 id="selectbattleslot"><a class="header" href="#selectbattleslot">selectBattleSlot</a></h3>
<p>Move to a battle slot to participate in the battle from.</p>
<pre><code class="language-javascript">const { battle } = store.state;

// Try to select the last slot (back right)
if (battle) {
  const lastSlotIndex = battle.width * battle.height - 1;
  await game.gameService.selectBattleSlot(lastSlotIndex);
}
</code></pre>
<h3 id="selectreserve"><a class="header" href="#selectreserve">selectReserve</a></h3>
<p>Move to the reserve position outside of the battle.</p>
<pre><code class="language-javascript">const { battle } = store.state;

if (battle) {
  await game.gameService.selectReserve();
}
</code></pre>
<h3 id="selectenemy"><a class="header" href="#selectenemy">selectEnemy</a></h3>
<p>Select the index of the enemy you want to target.</p>
<pre><code class="language-javascript">const { battle } = store.state;

// Try to select the last slot (back right)
if (battle) {
  const lastEnemyIndex = battle.enemies.length - 1;
  await game.gameService.selectBattleSlot(lastEnemyIndex);
}
</code></pre>
<h3 id="startscavenge"><a class="header" href="#startscavenge">startScavenge</a></h3>
<p>Start scavenging the specified battle.</p>
<pre><code class="language-javascript">const firstBattle = store.state.battles[0];

// Join the battle at the top of the list if there is one
if (firstBattle) {
  await game.gameService.startScavenge(firstBattle.id);
}
</code></pre>
<h3 id="stopscavenge"><a class="header" href="#stopscavenge">stopScavenge</a></h3>
<p>Stop scavenging the current battle.</p>
<pre><code class="language-javascript">const { player } = store.state.user;

// Leave the battle if currently in one
if (player.battleId) {
  await game.gameService.stopScavenge();
}
</code></pre>
<h3 id="startrepair"><a class="header" href="#startrepair">startRepair</a></h3>
<p>Start repairing the town.</p>
<pre><code class="language-javascript">await game.gameService.startRepair();
</code></pre>
<h3 id="stoprepair"><a class="header" href="#stoprepair">stopRepair</a></h3>
<p>Stop repairing the town.</p>
<pre><code class="language-javascript">await game.gameService.stopRepair();
</code></pre>
<h3 id="startbuild"><a class="header" href="#startbuild">startBuild</a></h3>
<p>Start building the specified building.</p>
<pre><code class="language-javascript">await game.gameService.startBuild();
</code></pre>
<h3 id="savetraining"><a class="header" href="#savetraining">saveTraining</a></h3>
<p>Save the training configuration. Must sum to no more than 1.0</p>
<pre><code class="language-javascript">const statDistributions = {
  hp: 0.25,
  dmg: 0.25,
  def: 0.25,
  heal: 0.25,
};

await game.gameService.saveTraining(statDistributions);
</code></pre>
<h3 id="endbattle"><a class="header" href="#endbattle">endBattle</a></h3>
<p>End a personal battle.</p>
<pre><code class="language-javascript">const { player } = store.state.user;

// Leave the battle if currently in one
if (player.battleId) {
  await game.gameService.endBattle();
}
</code></pre>
<h3 id="searchmarket"><a class="header" href="#searchmarket">searchMarket</a></h3>
<p>Search the market using the specified criteria. No criteria currently available, so this will return the first set of found items.</p>
<pre><code class="language-javascript">await game.gameService.searchMarket();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="player-service"><a class="header" href="#player-service">Player Service</a></h1>
<p>This service lets you interact with player specitic functionality, like the inventory.</p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<p><a href="Services/playerService.html#discarditems">discardItems</a></p>
<p><a href="Services/playerService.html#marketitem">marketItem</a></p>
<p><a href="Services/playerService.html#unmarketitem">unmarketItem</a></p>
<p><a href="Services/playerService.html#buymarketitem">buyMarketItem</a></p>
<p><a href="Services/playerService.html#getmarketitems">getMarketItems</a></p>
<hr />
<h3 id="discarditems"><a class="header" href="#discarditems">discardItems</a></h3>
<p>Discart the given item IDs</p>
<pre><code class="language-javascript">// Get and discard all inventory items
const itemIds = game.store.getInventory().map((item) =&gt; {
  return item.id;
});

await game.playerService.discardItems(itemIds);
</code></pre>
<h3 id="marketitem"><a class="header" href="#marketitem">marketItem</a></h3>
<p>Send an item to the market with a given price</p>
<pre><code class="language-javascript">// Send the first item in the inventory to the market
const item = game.store.getInventory()[0];

if (item) {
  await game.playerService.marketItem({ itemId: item.id, price: 1234 });
}
</code></pre>
<h3 id="unmarketitem"><a class="header" href="#unmarketitem">unmarketItem</a></h3>
<p>Remove an item from the market</p>
<pre><code class="language-javascript">// Remove the first marked item from the market
const myMarketItems = await game.playerService.getMarketItems();
const item = myMarketItems[0];

if (item) {
  await game.playerService.unmarketItem(item.id);
}
</code></pre>
<h3 id="buymarketitem"><a class="header" href="#buymarketitem">buyMarketItem</a></h3>
<p>Buy an item from the market</p>
<pre><code class="language-javascript">// Buy the first item in the market
const marketItems = await game.gameService.searchMarket();
const item = marketItems[0];

if (item) {
  await game.playerService.buyMarketItem(item.id);
}
</code></pre>
<h3 id="getmarketitems"><a class="header" href="#getmarketitems">getMarketItems</a></h3>
<p>Get a list of your marketed items</p>
<pre><code class="language-javascript">const myMarketItems = await game.playerService.getMarketItems();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toast-service"><a class="header" href="#toast-service">Toast Service</a></h1>
<p>This service allows you to create the notifications that you see on the bottom right side of the window.</p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<p><a href="Services/toastService.html#push">push</a></p>
<hr />
<h3 id="push"><a class="header" href="#push">push</a></h3>
<p>Push a &quot;toast&quot; onto the stack with the desired notification text</p>
<pre><code class="language-javascript">game.toastService.push({
  duration: 60000, // Stay visible for 1 minute (default: 5_000)
  text: &quot;Hello toast!&quot;,
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<p>This sections will contain example code to help get you started.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="more-code-examples-for-how-do-to-things"><a class="header" href="#more-code-examples-for-how-do-to-things">More code examples for how do to things</a></h3>
<ul>
<li>How to find an item with specific attributes</li>
</ul>
<h3 id="automate-service-documentation-generation"><a class="header" href="#automate-service-documentation-generation">Automate service documentation generation?</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:4000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
